#!/usr/bin/env bash

commit_msg=$(cat "$1")

pattern="^(build|chore|ci|docs|feat|fix|perf|refactor|revert|style|test)(\([\w\-\.]+\))?(!)?: .+"

if ! echo "$commit_msg" | grep -Eq "$pattern"; then
  echo ""
  echo "❌ Bad commit message:"
  echo "   \"$commit_msg\""
  echo ""
  echo "✅ Must follow Conventional Commits format:"
  echo ""
  echo "   type(scope): description"
  echo ""
  echo "   Allowed types:"
  echo "     feat, fix, docs, style, refactor,"
  echo "     perf, test, build, ci, chore, revert"
  echo ""
  echo "   Examples:"
  echo "     feat: add login page"
  echo "     fix(api): handle null response"
  echo "     docs: update README"
  echo ""
  exit 1
fi